\end{code}

I have tried to do a `print(vector_db.vectors)` and I get this as output:

\begin{blockquote}
[[105, 289, -23] ... (204 more entries)... [-16, -17, 20]]
\end{blockquote}

I also tried to do a `print(query)` and I got the following:

\begin{blockquote}
[[-0.59918382], [0.40081618]...] (7 more entries)
\end{blockquote}

It's very strange to me, since the `query` size is just half of that for the vectors. What am I doing wrong here? Why isn't the search working properly?

Answer: The problem is that you have an embedding dimension mismatch. Your query vector has 384 dimensions and your embedding dimension in `vector_db` is 768. This will result in the error when you try to do a similarity search on them. You can fix it by changing your embedding dimension to match that of your query, e.g.:

\begin{code}
embedding = Embedding(input_dim=384)
vector_db = vector_db.clone()
vector_db._transformed_input = embedding(vector_db._transformed_input)
\end{code}